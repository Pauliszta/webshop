{% extends "__base__.html" %}
{% load static %}
{% block title %}
    Koszyk na zakupy
{% endblock %}
{% block content %}
    <section class="padding-medium story">
        <div class="container">
            <form action="/update/" method="post">
            {% csrf_token %}
                <h2 class=" color-header text-uppercase">Twój koszyk</h2>
                    {% for item in cart_items %}
                    <table class="table borderless">

                        <tbody>
                        <tr class="d-flex">
                            <th scope="row" class="col-7">
                                {{ forloop.counter }}. {{ item.product.name  }} {{ item.product.category }} - {{ item.product.description }}</th>
                            <td class="col-2">
                                {{ item.product.price }} zł
                            </td>
                            <td class="col-2">
                                <input type="number" id="quantity_{{ item.product.id }}" name="quantity_{{ item.product.id }}"
                                       value="{{ item.quantity }}" min="1" max="{{ item.product.stock }}"> szt.
                            </td>
                            <td class="col-2">
                                {{ item.price }} zł
                            </td>
                        </tr>

                        </tbody>
                    </table>
                    {% endfor %}
            </form>
        </div>
        <div class="col d-flex justify-content-end mb-1">
            <h6> Koszt przesyłki: {{ shipping_cost }} zł</h6>
        </div>
        <div class="col d-flex justify-content-end mb-1">
            <h4 class="text-uppercase"> Suma: {{ total_price }} zł</h4>
        </div>
        <div>
            <h3> {{ error_message }}</h3>
        </div>
        <div class="col d-flex justify-content-end mb-1 padding-small">
            <form action="/view/" method="post">
                {% csrf_token %}
                <button class ="btn btn-warning rounded-0 text-light m-1" type="submit">Aktualizuj koszyk</button>
            </form>
             <form action="/delete/" method="post">
                {% csrf_token %}
                <button class ="btn btn-danger rounded-0 text-light m-1" type="submit">Usuń koszyk</button>
            </form>
            {%  if user.is_authenticated %}
                <form action="/orders/order-more-info/" method="post">
                    {%  csrf_token %}
                    <button class ="btn btn-color rounded-0 text-light m-1" type="submit">Dalej</button>
                </form>
            {% else %}
                <form action="/account/login/" method="post">
                    {%  csrf_token %}
                    <button class ="btn btn-color rounded-0 text-light m-1" type="submit">Dalej</button>
                </form>
            {%  endif %}
        </div>


    </section>
{% endblock %}